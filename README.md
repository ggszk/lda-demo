# レシート分析システム 🛒

高校生向けの体験授業用レシートデータ分析システムです。4つの支店の買い物パターンをLDA（潜在ディリクレ配分法）で分析し、Webで可視化します。

## 🎯 できること

- レシートデータから自動的に「買い物テーマ」を発見
- 支店ごとのテーマ分布をグラフで比較
- テーマ数を変更して異なる角度から分析
- 分析結果をわかりやすく解説

## 📋 必要なライブラリ

```bash
pip install flask pandas scikit-learn numpy
```

## 🚀 使用方法

### 1. Webアプリを起動

```bash
python app.py
```

### 2. ブラウザでアクセス

http://localhost:8080 にアクセス

### 3. 分析実行

- テーマ数を選択（3-7テーマ推奨）
- 「分析開始！」ボタンをクリック
- 結果がグラフで表示されます

### 4. コマンドライン分析（オプション）

```bash
python analysis.py
```

## 📊 分析結果の見方

### テーマとは？
- システムが自動的に発見した「買い物パターン」
- 例：「お菓子系」「日用品系」「食品系」など

### グラフの見方
- 横軸：4つの支店（中央区、北区、西区、東区）
- 縦軸：各テーマの割合（%）
- 色分けされた棒グラフで支店ごとの特徴を比較

### 発見の例
- 「中央区店はお菓子系商品が多い（35%）」
- 「北区店は日用品系商品が特徴的（28%）」

## 📁 ファイル構成

```
├── analysis.py              # LDA分析メイン処理
├── app.py                   # Webアプリケーション
├── レシートデータ_doc.csv    # 分析対象データ
├── templates/
│   └── index.html           # Webページ
├── static/
│   ├── style.css           # スタイルシート
│   └── main.js             # JavaScript
└── analysis_results.json   # 分析結果（自動生成）
```

## 🎓 教育的なポイント

1. **データ前処理**: 商品名をコンピューターが理解できる数値に変換
2. **機械学習**: LDAアルゴリズムでパターン発見
3. **データ可視化**: Chart.jsでインタラクティブなグラフ
4. **Webアプリ**: FlaskでPythonとHTMLを連携

## 🔧 カスタマイズ

### テーマ数の調整
`analysis.py`の最下部で調整可能：
```python
analyze_receipt_data(5)  # 5テーマで分析
```

### テーマ説明のカスタマイズ
`get_topic_description()`関数で商品カテゴリを調整可能

## 💡 トラブルシューティング

### よくある問題

1. **「Vocabulary not fitted」エラー**
   - データファイルの場所を確認
   - パスが正しいかチェック

2. **ブラウザで表示されない**
   - Flaskサーバーが起動しているか確認
   - ポート8080が使用中でないかチェック

3. **グラフが表示されない**
   - ブラウザのJavaScriptが有効か確認
   - ネットワーク接続でChart.jsが読み込めるかチェック

### デバッグモード
開発者向けに詳細なエラー情報を表示：
```python
app.run(debug=True)
```