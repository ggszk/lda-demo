# 設計メモ

## 現状の課題

### パフォーマンス
- リクエストのたびにLDA分析を実行しているため、30人同時利用でタイムアウトが発生しうる
- トピック数3〜7の全パターンを毎回計算している

### データ管理
- CSVファイルがアプリに埋め込まれている
- データを差し替えるにはデプロイが必要

---

## 設計方針（検討中）

### 分析と参照の分離

```
[先生が分析実施] → 結果を保存 → [生徒が参照]
```

- **分析エンドポイント**：トピック数3〜7を一括で計算して保存する
  - 実行は先生（管理者）のみ、授業前に1回実施
  - 完了まで時間がかかってよい
- **参照エンドポイント**：保存済みの結果を返すだけ
  - 30人が同時アクセスしても軽い

### データの外部化（検討）
- CSVをアプリに埋め込まず、外部から差し替えられるようにしたい
- 授業ごとに違うデータを使えるようにしたい
- 手段はGCS（Google Cloud Storage）等を検討

---

## フレームワーク選定

### 対象者による使い分け

| | Flask（現状） | Streamlit |
|---|---|---|
| コードの読みやすさ | HTML/JS/Pythonが分離していて複雑 | Pythonだけで完結、シンプル |
| 学習者が改造しやすいか | 難しい | しやすい |
| デザインの自由度 | 高い | 低い |
| 本格的なWeb開発の学習 | できる | できない |

### 方針
- **高校生向け体験授業** → 現状のFlaskのまま。デザインも作り込まれているので十分
- **大学生向けゼミ** → Streamlitで別途作る。「自分で改造する」演習に向いている

### Streamlit版について
- `analysis.py` の分析ロジックはそのまま流用可能
- UIより分析ロジックに集中できる点がゼミの演習に適している
- 必要になったタイミングで着手する

---

## 未検討の課題

- 分析結果の保存先（メモリ・ファイル・DB・GCS等）
- 分析エンドポイントの認証（先生だけが実行できるようにするか）
- データ差し替えのUI・フロー
